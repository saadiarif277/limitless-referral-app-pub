import{L as D}from"./index-D6YI7NWh.js";import{T as U,r as d,o as i,c as m,a as o,w as r,d as C,F as g,b as n,t as _,f as p,e as f,g as z}from"./app-B3zO_ILq.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./focus-management-C4nM2lYB.js";import"./keyboard-DTUPi9Wy.js";import"./disposables-BnUz9YMx.js";import"./description-BoEneSfX.js";const T={name:"AppointmentsCreateEdit",layout:D,props:{appointment:{type:Object,required:!1,default:()=>{}},appointmentTypes:{type:Object,required:!0},organizations:{type:Object,required:!0},patients:{type:Object,required:!0},referral:{type:Object,required:!1,default:()=>{}}},data(){return{form:U({referral_id:"",appointment_type_id:"",organization_id:"",description:"",patient_user_id:"",start_date:"",end_date:""})}},watch:{appointment:{handler(t){!t||!t.data||(this.form.description=t.data.description,this.form.appointment_type_id=t.data.appointment_type_id,this.form.organization_id=t.data.organization_id,this.form.patient_user_id=t.data.patient_user_id,this.form.start_date=t.data.start_date,this.form.end_date=t.data.end_date,t.data.referral&&(this.form.referral_id=t.data.referral.referral_id))},immediate:!0},referral:{handler(t){!t||!t.data||this.appointment||(this.form.referral_id=t.data.referral_id,this.form.organization_id=t.data.organization_id,this.form.patient_user_id=t.data.patient_user_id)},immediate:!0},"form.start_date":{handler(t){let s=t+"Z",a=new Date(s);a.setUTCHours(a.getUTCHours()+1);let b=a.toISOString().split(".")[0];this.form.end_date=b}}},methods:{submitForm(){this.form.clearErrors(),this.appointment&&this.appointment.data&&this.appointment.data.appointment_id?this.updateRequest():this.storeRequest()},storeRequest(){this.form.post(this.route("panel.appointments.store"),{onSuccess:()=>this.$toast().success("Appointment created successfully!"),onError:t=>{Object.keys(t).forEach(s=>{const a=t[s];this.$toast().error(a)})}})},updateRequest(){this.form.patch(this.route("panel.appointments.update",{appointment:this.appointment.data.appointment_id}),{onSuccess:()=>this.$toast().success("Appointment updated successfully!"),onError:t=>{Object.keys(t).forEach(s=>{const a=t[s];this.$toast().error(a)})}})},deleteRequest(){this.$alert().confirm(()=>new Promise((t,s)=>{this.form.delete(this.route("panel.appointments.destroy",{appointment:this.appointment.data.appointment_id}),{onSuccess:()=>{this.$toast().success("Appointment deleted successfully!"),t()},onError:a=>{Object.keys(a).forEach(b=>{const e=a[b];this.$toast().error(e)}),s()}})}))}}},B={key:0},N={key:0,class:"flex gap-2"},P=z("span",{class:"text-red-500 font-bold"},"Error: Referral not found.",-1),H=z("br",null,null,-1),I={key:1,class:"grid grid-cols-1 divide-y divide-gray-200 gap-12 pb-12"},L={key:0,class:"italic"},G=["value"];function M(t,s,a,b,e,w){const q=d("v-inertia-head"),k=d("v-link"),y=d("v-button"),S=d("v-section-heading"),v=d("v-content-body"),x=d("v-paragraph"),O=d("v-section-divider"),c=d("v-form-label"),V=d("v-form-select"),h=d("v-form-error"),u=d("v-form-group"),E=d("v-form-input"),j=d("v-form-textarea"),R=d("v-form");return i(),m(g,null,[o(q,{title:a.appointment?"Editing appointment.":"Create Appointment"},null,8,["title"]),o(R,{class:"h-full",onSubmit:C(w.submitForm,["prevent"])},{default:r(()=>[o(v,{class:"border-b border-gray-200"},{default:r(()=>[o(S,null,{title:r(()=>[a.appointment?(i(),m(g,{key:1},[n(" Editing appointment. ")],64)):(i(),m(g,{key:0},[n(" Create Appointment "),e.form.referral_id?(i(),m("span",B,[n(" for the referral "),o(k,{href:t.route("panel.referrals.show",{referral:e.form.referral_id})},{default:r(()=>[n('"REF#'+_(e.form.referral_id)+'"',1)]),_:1},8,["href"])])):p("",!0)],64))]),description:r(()=>[a.appointment?(i(),m(g,{key:1},[n(" Change and/or modify the details for the appointment. ")],64)):(i(),m(g,{key:0},[n(" Fill up the form below to create a new appointment for the application. ")],64))]),actions:r(()=>[a.appointment?(i(),m("div",N,[this.$auth().can(["referral.show","referral.show-own"])?(i(),m(g,{key:0},[e.form.referral_id?(i(),f(y,{key:0,href:t.route("panel.referrals.show",{referral:e.form.referral_id}),disabled:e.form.processing,color:"white"},{default:r(()=>[n(" View Referral ")]),_:1},8,["href","disabled"])):p("",!0)],64)):p("",!0),this.$auth().can(["appointment.destroy"])?(i(),f(y,{key:1,color:"danger",disabled:e.form.processing,onClick:C(w.deleteRequest,["prevent"])},{default:r(()=>[n(" Delete Appointment ")]),_:1},8,["disabled","onClick"])):p("",!0)])):p("",!0)]),_:1})]),_:1}),!a.appointment&&!e.form.referral_id?(i(),f(v,{key:0},{default:r(()=>[o(x,null,{default:r(()=>[P,n(),H,n(" Please create an appointment via a referral "),o(k,{href:t.route("panel.referrals.index")},{default:r(()=>[n("here.")]),_:1},8,["href"])]),_:1})]),_:1})):(i(),m("div",I,[o(u,{class:"divide-y divide-gray-200"},{default:r(()=>[o(O,null,{default:r(()=>[n(" General Details ")]),_:1}),o(v,{class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-4"},{default:r(()=>[o(u,null,{default:r(()=>[o(c,null,{default:r(()=>[n("Appointment Type")]),_:1}),o(V,{options:a.appointmentTypes.data.map(l=>({label:l.name,value:l.appointment_type_id})),error:e.form.errors.appointment_type_id,disabled:e.form.processing,modelValue:e.form.appointment_type_id,"onUpdate:modelValue":s[0]||(s[0]=l=>e.form.appointment_type_id=l)},null,8,["options","error","disabled","modelValue"]),e.form.errors.appointment_type_id?(i(),f(h,{key:0},{default:r(()=>[n(_(e.form.errors.appointment_type_id),1)]),_:1})):p("",!0)]),_:1}),o(u,null,{default:r(()=>[o(c,null,{default:r(()=>[n(" Organization ")]),_:1}),o(V,{options:a.organizations.data.map(({name:l,organization_id:A})=>({label:l,value:A})),error:e.form.errors.organization_id,disabled:e.form.processing,required:!0,modelValue:e.form.organization_id,"onUpdate:modelValue":s[1]||(s[1]=l=>e.form.organization_id=l)},null,8,["options","error","disabled","modelValue"]),e.form.errors.organization_id?(i(),f(h,{key:0},{default:r(()=>[n(_(e.form.errors.organization_id),1)]),_:1})):p("",!0)]),_:1}),o(u,{class:"md:col-span-2"},{default:r(()=>[o(c,null,{default:r(()=>[n(" Patient "),e.form.referral_id?(i(),m("span",L,[n(" (Inherited from "),o(k,{href:t.route("panel.referrals.show",{referral:e.form.referral_id})},{default:r(()=>[n('"REF#'+_(e.form.referral_id)+'"',1)]),_:1},8,["href"]),n(") ")])):p("",!0)]),_:1}),o(V,{options:a.patients.data.map(l=>({label:l.name,value:l.user_id})),error:e.form.errors.patient_user_id,disabled:e.form.processing||!!e.form.referral_id,modelValue:e.form.patient_user_id,"onUpdate:modelValue":s[2]||(s[2]=l=>e.form.patient_user_id=l)},null,8,["options","error","disabled","modelValue"]),e.form.errors.patient_user_id?(i(),f(h,{key:0},{default:r(()=>[n(_(e.form.errors.patient_user_id),1)]),_:1})):p("",!0)]),_:1}),o(u,{class:"md:col-span-2"},{default:r(()=>[o(c,null,{default:r(()=>[n("Start Date")]),_:1}),o(E,{type:"datetime-local",modelValue:e.form.start_date,"onUpdate:modelValue":s[3]||(s[3]=l=>e.form.start_date=l),error:e.form.errors.start_date,disabled:e.form.processing},null,8,["modelValue","error","disabled"]),e.form.errors.start_date?(i(),f(h,{key:0},{default:r(()=>[n(_(e.form.errors.start_date),1)]),_:1})):p("",!0)]),_:1}),o(u,{class:"md:col-span-2"},{default:r(()=>[o(c,null,{default:r(()=>[n("End Date")]),_:1}),o(E,{type:"datetime-local",modelValue:e.form.end_date,"onUpdate:modelValue":s[4]||(s[4]=l=>e.form.end_date=l),error:e.form.errors.end_date,disabled:e.form.processing},null,8,["modelValue","error","disabled"]),e.form.errors.end_date?(i(),f(h,{key:0},{default:r(()=>[n(_(e.form.errors.end_date),1)]),_:1})):p("",!0)]),_:1}),o(u,{class:"col-span-full"},{default:r(()=>[o(c,null,{default:r(()=>[n("Description")]),_:1}),o(j,{modelValue:e.form.description,"onUpdate:modelValue":s[5]||(s[5]=l=>e.form.description=l),error:e.form.errors.description,disabled:e.form.processing},null,8,["modelValue","error","disabled"]),e.form.errors.description?(i(),f(h,{key:0},{default:r(()=>[n(_(e.form.errors.description),1)]),_:1})):p("",!0)]),_:1})]),_:1})]),_:1})])),o(u,{class:"bg-gray-50 flex items-center justify-end gap-2 text-right border-t border-gray-200"},{default:r(()=>[o(v,{class:"flex gap-4"},{default:r(()=>[e.form.progress?(i(),m("progress",{key:0,value:e.form.progress.percentage,max:"100"},_(e.form.progress.percentage)+"% ",9,G)):p("",!0),o(y,{href:t.route("panel.appointments.index"),color:"white",disabled:e.form.processing},{default:r(()=>[n(" Cancel ")]),_:1},8,["href","disabled"]),a.appointment?(i(),f(y,{key:2,disabled:e.form.processing},{default:r(()=>[n(" Save Changes ")]),_:1},8,["disabled"])):(i(),f(y,{key:1,disabled:e.form.processing||!e.form.referral_id},{default:r(()=>[n(" Create Appointment ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["onSubmit"])],64)}const $=F(T,[["render",M]]);export{$ as default};
