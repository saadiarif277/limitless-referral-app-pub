import{y as S,M as ee,E as Re,u as j,_ as ve,$ as Te,x as P,i as K,s as Ee,S as B,G as ye,C as de,j as te,F as ue,B as le,q as Se,D as Me,I as L,L as _e,r as U,o as A,e as Y,w as G,g as N,a as pe,c as X,l as fe,n as ae,t as me,f as se,d as ke,b as ze}from"./app-B3zO_ILq.js";import{_ as Pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as Ve,e as De}from"./form-DQRL17nw.js";import{u as H,o as O,f as Fe,E as $e,s as Ae,A as W,T as ce,I as Q,N as oe,a as D}from"./keyboard-DTUPi9Wy.js";import{c as Be,d as Ne,i as ne,l as Le,o as he,a as be,n as je}from"./disposables-BnUz9YMx.js";import{s as Ke}from"./use-resolve-button-type-6dw-1KCi.js";import{i as qe}from"./use-tree-walker-DO4pf2ts.js";import{i as Ue,O as Ze}from"./focus-management-C4nM2lYB.js";function Z(l,s,e){let n=e.initialDeps??[],t;return()=>{var i,a,o,v;let m;e.key&&((i=e.debug)!=null&&i.call(e))&&(m=Date.now());const p=l();if(!(p.length!==n.length||p.some((y,I)=>n[I]!==y)))return t;n=p;let h;if(e.key&&((a=e.debug)!=null&&a.call(e))&&(h=Date.now()),t=s(...p),e.key&&((o=e.debug)!=null&&o.call(e))){const y=Math.round((Date.now()-m)*100)/100,I=Math.round((Date.now()-h)*100)/100,z=I/16,F=(b,C)=>{for(b=String(b);b.length<C;)b=" "+b;return b};console.info(`%c⏱ ${F(I,5)} /${F(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*z,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(v=e==null?void 0:e.onChange)==null||v.call(e,t),t}}function re(l,s){if(l===void 0)throw new Error(`Unexpected undefined${s?`: ${s}`:""}`);return l}const He=(l,s)=>Math.abs(l-s)<1,We=l=>l,Je=l=>{const s=Math.max(l.startIndex-l.overscan,0),e=Math.min(l.endIndex+l.overscan,l.count-1),n=[];for(let t=s;t<=e;t++)n.push(t);return n},Ye=(l,s)=>{const e=l.scrollElement;if(!e)return;const n=i=>{const{width:a,height:o}=i;s({width:Math.round(a),height:Math.round(o)})};if(n(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const t=new ResizeObserver(i=>{const a=i[0];if(a!=null&&a.borderBoxSize){const o=a.borderBoxSize[0];if(o){n({width:o.inlineSize,height:o.blockSize});return}}n(e.getBoundingClientRect())});return t.observe(e,{box:"border-box"}),()=>{t.unobserve(e)}},Ge=(l,s)=>{const e=l.scrollElement;if(!e)return;const n=()=>{s(e[l.options.horizontal?"scrollLeft":"scrollTop"])};return n(),e.addEventListener("scroll",n,{passive:!0}),()=>{e.removeEventListener("scroll",n)}},Xe=(l,s,e)=>{if(s!=null&&s.borderBoxSize){const n=s.borderBoxSize[0];if(n)return Math.round(n[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(l.getBoundingClientRect()[e.options.horizontal?"width":"height"])},Qe=(l,{adjustments:s=0,behavior:e},n)=>{var t,i;const a=l+s;(i=(t=n.scrollElement)==null?void 0:t.scrollTo)==null||i.call(t,{[n.options.horizontal?"left":"top"]:a,behavior:e})};class et{constructor(s){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const n=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(t=>{t.forEach(i=>{this._measureElement(i.target,i)})}):null);return{disconnect:()=>{var t;return(t=n())==null?void 0:t.disconnect()},observe:t=>{var i;return(i=n())==null?void 0:i.observe(t,{box:"border-box"})},unobserve:t=>{var i;return(i=n())==null?void 0:i.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([n,t])=>{typeof t>"u"&&delete e[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:We,rangeExtractor:Je,onChange:()=>{},measureElement:Xe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,...e}},this.notify=e=>{var n,t;(t=(n=this.options).onChange)==null||t.call(n,this,e)},this.maybeNotify=Z(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,n=>{this.scrollAdjustments=0,this.scrollOffset!==n&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<n?"forward":"backward",this.scrollOffset=n,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=Z(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,n,t,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:n,scrollMargin:t,getItemKey:i}),{key:!1}),this.getFurthestMeasurement=(e,n)=>{const t=new Map,i=new Map;for(let a=n-1;a>=0;a--){const o=e[a];if(t.has(o.lane))continue;const v=i.get(o.lane);if(v==null||o.end>v.end?i.set(o.lane,o):o.end<v.end&&t.set(o.lane,!0),t.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurements=Z(()=>[this.memoOptions(),this.itemSizeCache],({count:e,paddingStart:n,scrollMargin:t,getItemKey:i},a)=>{const o=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,o);for(let m=o;m<e;m++){const p=i(m),f=this.options.lanes===1?v[m-1]:this.getFurthestMeasurement(v,m),h=f?f.end+this.options.gap:n+t,y=a.get(p),I=typeof y=="number"?y:this.options.estimateSize(m),z=h+I,F=f?f.lane:m%this.options.lanes;v[m]={index:m,start:h,size:I,end:z,key:p,lane:F}}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Z(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,n,t)=>this.range=e.length>0&&n>0?tt({measurements:e,outerSize:n,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=Z(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,n,t,i)=>n===null?[]:e({...n,overscan:t,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const n=this.options.indexAttribute,t=e.getAttribute(n);return t?parseInt(t,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(e,n)=>{const t=this.measurementsCache[this.indexFromElement(e)];if(!t||!e.isConnected){this.measureElementCache.forEach((o,v)=>{o===e&&(this.observer.unobserve(e),this.measureElementCache.delete(v))});return}const i=this.measureElementCache.get(t.key);i!==e&&(i&&this.observer.unobserve(i),this.observer.observe(e),this.measureElementCache.set(t.key,e));const a=this.options.measureElement(e,n,this);this.resizeItem(t,a)},this.resizeItem=(e,n)=>{const t=this.itemSizeCache.get(e.key)??e.size,i=n-t;i!==0&&(e.start<this.scrollOffset+this.scrollAdjustments&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,n)),this.notify(!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=Z(()=>[this.getIndexes(),this.getMeasurements()],(e,n)=>{const t=[];for(let i=0,a=e.length;i<a;i++){const o=e[i],v=n[o];t.push(v)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const n=this.getMeasurements();return re(n[Oe(0,n.length-1,t=>re(n[t]).start,e)])},this.getOffsetForAlignment=(e,n)=>{const t=this.getSize();n==="auto"&&(e<=this.scrollOffset?n="start":e>=this.scrollOffset+t?n="end":n="start"),n==="start"?e=e:n==="end"?e=e-t:n==="center"&&(e=e-t/2);const i=this.options.horizontal?"scrollWidth":"scrollHeight",o=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-this.getSize();return Math.max(Math.min(o,e),0)},this.getOffsetForIndex=(e,n="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=re(this.getMeasurements()[e]);if(n==="auto")if(t.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)n="end";else if(t.start<=this.scrollOffset+this.options.scrollPaddingStart)n="start";else return[this.scrollOffset,n];const i=n==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,n),n]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:n="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,n),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:n="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[i,a]=this.getOffsetForIndex(e,n);this._scrollToOffset(i,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[v]=this.getOffsetForIndex(e,a);He(v,this.scrollOffset)||this.scrollToIndex(e,{align:a,behavior:t})}else this.scrollToIndex(e,{align:a,behavior:t})}))},this.scrollBy=(e,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var e;const n=this.getMeasurements();let t;return n.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=n[n.length-1])==null?void 0:e.end)??0:Math.max(...n.slice(-this.options.lanes).map(i=>i.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:n,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(s),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.maybeNotify()}}const Oe=(l,s,e,n)=>{for(;l<=s;){const t=(l+s)/2|0,i=e(t);if(i<n)l=t+1;else if(i>n)s=t-1;else return t}return l>0?l-1:0};function tt({measurements:l,outerSize:s,scrollOffset:e}){const n=l.length-1,i=Oe(0,n,o=>l[o].start,e);let a=i;for(;a<n&&l[a].end<e+s;)a++;return{startIndex:i,endIndex:a}}function lt(l){const s=new et(ee(l)),e=Re(s),n=s._didMount();return j(()=>ee(l).getScrollElement(),t=>{t&&s._willUpdate()},{immediate:!0}),j(()=>ee(l),t=>{s.setOptions({...t,onChange:(i,a)=>{var o;ve(e),(o=t.onChange)==null||o.call(t,i,a)}}),s._willUpdate(),ve(e)},{immediate:!0}),Te(n),e}function ot(l){return lt(S(()=>({observeElementRect:Ye,observeElementOffset:Ge,scrollToFn:Qe,...ee(l)})))}function ge(l){return[l.screenX,l.screenY]}function nt(){let l=P([-1,-1]);return{wasMoved(s){let e=ge(s);return l.value[0]===e[0]&&l.value[1]===e[1]?!1:(l.value=e,!0)},update(s){l.value=ge(s)}}}function it(l){throw new Error("Unexpected object: "+l)}var k=(l=>(l[l.First=0]="First",l[l.Previous=1]="Previous",l[l.Next=2]="Next",l[l.Last=3]="Last",l[l.Specific=4]="Specific",l[l.Nothing=5]="Nothing",l))(k||{});function xe(l,s){let e=s.resolveItems();if(e.length<=0)return null;let n=s.resolveActiveIndex(),t=n??-1;switch(l.focus){case 0:{for(let i=0;i<e.length;++i)if(!s.resolveDisabled(e[i],i,e))return i;return n}case 1:{t===-1&&(t=e.length);for(let i=t-1;i>=0;--i)if(!s.resolveDisabled(e[i],i,e))return i;return n}case 2:{for(let i=t+1;i<e.length;++i)if(!s.resolveDisabled(e[i],i,e))return i;return n}case 3:{for(let i=e.length-1;i>=0;--i)if(!s.resolveDisabled(e[i],i,e))return i;return n}case 4:{for(let i=0;i<e.length;++i)if(s.resolveId(e[i],i,e)===l.id)return i;return n}case 5:return null;default:it(l)}}var at={};function st(l,s){return l===s}var rt=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(rt||{}),ut=(l=>(l[l.Single=0]="Single",l[l.Multi=1]="Multi",l))(ut||{}),dt=(l=>(l[l.Pointer=0]="Pointer",l[l.Focus=1]="Focus",l[l.Other=2]="Other",l))(dt||{});let Ie=Symbol("ComboboxContext");function q(l){let s=Se(Ie,null);if(s===null){let e=new Error(`<${l} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,q),e}return s}let Ce=Symbol("VirtualContext"),ct=K({name:"VirtualProvider",setup(l,{slots:s}){let e=q("VirtualProvider"),n=S(()=>{let o=O(e.optionsRef);if(!o)return{start:0,end:0};let v=window.getComputedStyle(o);return{start:parseFloat(v.paddingBlockStart||v.paddingTop),end:parseFloat(v.paddingBlockEnd||v.paddingBottom)}}),t=ot(S(()=>({scrollPaddingStart:n.value.start,scrollPaddingEnd:n.value.end,count:e.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return O(e.optionsRef)},overscan:12}))),i=S(()=>{var o;return(o=e.virtual.value)==null?void 0:o.options}),a=P(0);return j([i],()=>{a.value+=1}),ye(Ce,e.virtual.value?t:null),()=>[te("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:o=>{if(o){if(typeof process<"u"&&at.JEST_WORKER_ID!==void 0||e.activationTrigger.value===0)return;e.activeOptionIndex.value!==null&&e.virtual.value.options.length>e.activeOptionIndex.value&&t.value.scrollToIndex(e.activeOptionIndex.value)}}},t.value.getVirtualItems().map(o=>_e(s.default({option:e.virtual.value.options[o.index],open:e.comboboxState.value===0})[0],{key:`${a.value}-${o.index}`,"data-index":o.index,"aria-setsize":e.virtual.value.options.length,"aria-posinset":o.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${o.start}px)`,overflowAnchor:"none"}})))]}}),vt=K({name:"Combobox",emits:{"update:modelValue":l=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(l,{slots:s,attrs:e,emit:n}){let t=P(1),i=P(null),a=P(null),o=P(null),v=P(null),m=P({static:!1,hold:!1}),p=P([]),f=P(null),h=P(2),y=P(!1);function I(u=c=>c){let c=f.value!==null?p.value[f.value]:null,g=u(p.value.slice()),x=g.length>0&&g[0].dataRef.order.value!==null?g.sort((E,$)=>E.dataRef.order.value-$.dataRef.order.value):Ze(g,E=>O(E.dataRef.domRef)),T=c?x.indexOf(c):null;return T===-1&&(T=null),{options:x,activeOptionIndex:T}}let z=S(()=>l.multiple?1:0),F=S(()=>l.nullable),[b,C]=Ve(S(()=>l.modelValue),u=>n("update:modelValue",u),S(()=>l.defaultValue)),V=S(()=>b.value===void 0?H(z.value,{1:[],0:void 0}):b.value),d=null,R=null;function w(u){return H(z.value,{0(){return C==null?void 0:C(u)},1:()=>{let c=B(r.value.value).slice(),g=B(u),x=c.findIndex(T=>r.compare(g,B(T)));return x===-1?c.push(g):c.splice(x,1),C==null?void 0:C(c)}})}let M=S(()=>{});j([M],([u],[c])=>{if(r.virtual.value&&u&&c&&f.value!==null){let g=u.indexOf(c[f.value]);g!==-1?f.value=g:f.value=null}});let r={comboboxState:t,value:V,mode:z,compare(u,c){if(typeof l.by=="string"){let g=l.by;return(u==null?void 0:u[g])===(c==null?void 0:c[g])}return l.by===null?st(u,c):l.by(u,c)},calculateIndex(u){return r.virtual.value?l.by===null?r.virtual.value.options.indexOf(u):r.virtual.value.options.findIndex(c=>r.compare(c,u)):p.value.findIndex(c=>r.compare(c.dataRef.value,u))},defaultValue:S(()=>l.defaultValue),nullable:F,immediate:S(()=>!1),virtual:S(()=>null),inputRef:a,labelRef:i,buttonRef:o,optionsRef:v,disabled:S(()=>l.disabled),options:p,change(u){C(u)},activeOptionIndex:S(()=>{if(y.value&&f.value===null&&(r.virtual.value?r.virtual.value.options.length>0:p.value.length>0)){if(r.virtual.value){let c=r.virtual.value.options.findIndex(g=>{var x;return!((x=r.virtual.value)!=null&&x.disabled(g))});if(c!==-1)return c}let u=p.value.findIndex(c=>!c.dataRef.disabled);if(u!==-1)return u}return f.value}),activationTrigger:h,optionsPropsRef:m,closeCombobox(){y.value=!1,!l.disabled&&t.value!==1&&(t.value=1,f.value=null)},openCombobox(){if(y.value=!0,!l.disabled&&t.value!==0){if(r.value.value){let u=r.calculateIndex(r.value.value);u!==-1&&(f.value=u)}t.value=0}},setActivationTrigger(u){h.value=u},goToOption(u,c,g){y.value=!1,d!==null&&cancelAnimationFrame(d),d=requestAnimationFrame(()=>{if(l.disabled||v.value&&!m.value.static&&t.value===1)return;if(r.virtual.value){f.value=u===k.Specific?c:xe({focus:u},{resolveItems:()=>r.virtual.value.options,resolveActiveIndex:()=>{var E,$;return($=(E=r.activeOptionIndex.value)!=null?E:r.virtual.value.options.findIndex(ie=>{var J;return!((J=r.virtual.value)!=null&&J.disabled(ie))}))!=null?$:null},resolveDisabled:E=>r.virtual.value.disabled(E),resolveId(){throw new Error("Function not implemented.")}}),h.value=g??2;return}let x=I();if(x.activeOptionIndex===null){let E=x.options.findIndex($=>!$.dataRef.disabled);E!==-1&&(x.activeOptionIndex=E)}let T=u===k.Specific?c:xe({focus:u},{resolveItems:()=>x.options,resolveActiveIndex:()=>x.activeOptionIndex,resolveId:E=>E.id,resolveDisabled:E=>E.dataRef.disabled});f.value=T,h.value=g??2,p.value=x.options})},selectOption(u){let c=p.value.find(x=>x.id===u);if(!c)return;let{dataRef:g}=c;w(g.value)},selectActiveOption(){if(r.activeOptionIndex.value!==null){if(r.virtual.value)w(r.virtual.value.options[r.activeOptionIndex.value]);else{let{dataRef:u}=p.value[r.activeOptionIndex.value];w(u.value)}r.goToOption(k.Specific,r.activeOptionIndex.value)}},registerOption(u,c){let g=Ee({id:u,dataRef:c});if(r.virtual.value){p.value.push(g);return}R&&cancelAnimationFrame(R);let x=I(T=>(T.push(g),T));f.value===null&&r.isSelected(c.value.value)&&(x.activeOptionIndex=x.options.indexOf(g)),p.value=x.options,f.value=x.activeOptionIndex,h.value=2,x.options.some(T=>!O(T.dataRef.domRef))&&(R=requestAnimationFrame(()=>{let T=I();p.value=T.options,f.value=T.activeOptionIndex}))},unregisterOption(u,c){if(d!==null&&cancelAnimationFrame(d),c&&(y.value=!0),r.virtual.value){p.value=p.value.filter(x=>x.id!==u);return}let g=I(x=>{let T=x.findIndex(E=>E.id===u);return T!==-1&&x.splice(T,1),x});p.value=g.options,f.value=g.activeOptionIndex,h.value=2},isSelected(u){return H(z.value,{0:()=>r.compare(B(r.value.value),B(u)),1:()=>B(r.value.value).some(c=>r.compare(B(c),B(u)))})},isActive(u){return f.value===r.calculateIndex(u)}};Be([a,o,v],()=>r.closeCombobox(),S(()=>t.value===0)),ye(Ie,r),Ne(S(()=>H(t.value,{0:ne.Open,1:ne.Closed})));let _=S(()=>{var u;return(u=O(a))==null?void 0:u.closest("form")});return de(()=>{j([_],()=>{if(!_.value||l.defaultValue===void 0)return;function u(){r.change(l.defaultValue)}return _.value.addEventListener("reset",u),()=>{var c;(c=_.value)==null||c.removeEventListener("reset",u)}},{immediate:!0})}),()=>{var u,c,g;let{name:x,disabled:T,form:E,...$}=l,ie={open:t.value===0,disabled:T,activeIndex:r.activeOptionIndex.value,activeOption:r.activeOptionIndex.value===null?null:r.virtual.value?r.virtual.value.options[(u=r.activeOptionIndex.value)!=null?u:0]:(g=(c=r.options.value[r.activeOptionIndex.value])==null?void 0:c.dataRef.value)!=null?g:null,value:V.value};return te(ue,[...x!=null&&V.value!=null?De({[x]:V.value}).map(([J,we])=>te(Fe,$e({features:Ae.Hidden,key:J,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:E,name:J,value:we}))):[],W({theirProps:{...e,...ce($,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:ie,slots:s,attrs:e,name:"Combobox"})])}}}),pt=K({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:null}},setup(l,{attrs:s,slots:e}){var n;let t=(n=l.id)!=null?n:`headlessui-combobox-label-${Q()}`,i=q("ComboboxLabel");function a(){var o;(o=O(i.inputRef))==null||o.focus({preventScroll:!0})}return()=>{let o={open:i.comboboxState.value===0,disabled:i.disabled.value},{...v}=l,m={id:t,ref:i.labelRef,onClick:a};return W({ourProps:m,theirProps:v,slot:o,attrs:s,slots:e,name:"ComboboxLabel"})}}}),ft=K({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(l,{attrs:s,slots:e,expose:n}){var t;let i=(t=l.id)!=null?t:`headlessui-combobox-button-${Q()}`,a=q("ComboboxButton");n({el:a.buttonRef,$el:a.buttonRef});function o(p){a.disabled.value||(a.comboboxState.value===0?a.closeCombobox():(p.preventDefault(),a.openCombobox()),L(()=>{var f;return(f=O(a.inputRef))==null?void 0:f.focus({preventScroll:!0})}))}function v(p){switch(p.key){case D.ArrowDown:p.preventDefault(),p.stopPropagation(),a.comboboxState.value===1&&a.openCombobox(),L(()=>{var f;return(f=a.inputRef.value)==null?void 0:f.focus({preventScroll:!0})});return;case D.ArrowUp:p.preventDefault(),p.stopPropagation(),a.comboboxState.value===1&&(a.openCombobox(),L(()=>{a.value.value||a.goToOption(k.Last)})),L(()=>{var f;return(f=a.inputRef.value)==null?void 0:f.focus({preventScroll:!0})});return;case D.Escape:if(a.comboboxState.value!==0)return;p.preventDefault(),a.optionsRef.value&&!a.optionsPropsRef.value.static&&p.stopPropagation(),a.closeCombobox(),L(()=>{var f;return(f=a.inputRef.value)==null?void 0:f.focus({preventScroll:!0})});return}}let m=Ke(S(()=>({as:l.as,type:s.type})),a.buttonRef);return()=>{var p,f;let h={open:a.comboboxState.value===0,disabled:a.disabled.value,value:a.value.value},{...y}=l,I={ref:a.buttonRef,id:i,type:m.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(p=O(a.optionsRef))==null?void 0:p.id,"aria-expanded":a.comboboxState.value===0,"aria-labelledby":a.labelRef.value?[(f=O(a.labelRef))==null?void 0:f.id,i].join(" "):void 0,disabled:a.disabled.value===!0?!0:void 0,onKeydown:v,onClick:o};return W({ourProps:I,theirProps:y,slot:h,attrs:s,slots:e,name:"ComboboxButton"})}}}),mt=K({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:l=>!0},setup(l,{emit:s,attrs:e,slots:n,expose:t}){var i;let a=(i=l.id)!=null?i:`headlessui-combobox-input-${Q()}`,o=q("ComboboxInput"),v=S(()=>Ue(O(o.inputRef))),m={value:!1};t({el:o.inputRef,$el:o.inputRef});function p(){o.change(null);let d=O(o.optionsRef);d&&(d.scrollTop=0),o.goToOption(k.Nothing)}let f=S(()=>{var d;let R=o.value.value;return O(o.inputRef)?typeof l.displayValue<"u"&&R!==void 0?(d=l.displayValue(R))!=null?d:"":typeof R=="string"?R:"":""});de(()=>{j([f,o.comboboxState,v],([d,R],[w,M])=>{if(m.value)return;let r=O(o.inputRef);r&&((M===0&&R===1||d!==w)&&(r.value=d),requestAnimationFrame(()=>{var _;if(m.value||!r||((_=v.value)==null?void 0:_.activeElement)!==r)return;let{selectionStart:u,selectionEnd:c}=r;Math.abs((c??0)-(u??0))===0&&u===0&&r.setSelectionRange(r.value.length,r.value.length)}))},{immediate:!0}),j([o.comboboxState],([d],[R])=>{if(d===0&&R===1){if(m.value)return;let w=O(o.inputRef);if(!w)return;let M=w.value,{selectionStart:r,selectionEnd:_,selectionDirection:u}=w;w.value="",w.value=M,u!==null?w.setSelectionRange(r,_,u):w.setSelectionRange(r,_)}})});let h=P(!1);function y(){h.value=!0}function I(){he().nextFrame(()=>{h.value=!1})}function z(d){switch(m.value=!0,d.key){case D.Enter:if(m.value=!1,o.comboboxState.value!==0||h.value)return;if(d.preventDefault(),d.stopPropagation(),o.activeOptionIndex.value===null){o.closeCombobox();return}o.selectActiveOption(),o.mode.value===0&&o.closeCombobox();break;case D.ArrowDown:return m.value=!1,d.preventDefault(),d.stopPropagation(),H(o.comboboxState.value,{0:()=>o.goToOption(k.Next),1:()=>o.openCombobox()});case D.ArrowUp:return m.value=!1,d.preventDefault(),d.stopPropagation(),H(o.comboboxState.value,{0:()=>o.goToOption(k.Previous),1:()=>{o.openCombobox(),L(()=>{o.value.value||o.goToOption(k.Last)})}});case D.Home:if(d.shiftKey)break;return m.value=!1,d.preventDefault(),d.stopPropagation(),o.goToOption(k.First);case D.PageUp:return m.value=!1,d.preventDefault(),d.stopPropagation(),o.goToOption(k.First);case D.End:if(d.shiftKey)break;return m.value=!1,d.preventDefault(),d.stopPropagation(),o.goToOption(k.Last);case D.PageDown:return m.value=!1,d.preventDefault(),d.stopPropagation(),o.goToOption(k.Last);case D.Escape:if(m.value=!1,o.comboboxState.value!==0)return;d.preventDefault(),o.optionsRef.value&&!o.optionsPropsRef.value.static&&d.stopPropagation(),o.nullable.value&&o.mode.value===0&&o.value.value===null&&p(),o.closeCombobox();break;case D.Tab:if(m.value=!1,o.comboboxState.value!==0)return;o.mode.value===0&&o.activationTrigger.value!==1&&o.selectActiveOption(),o.closeCombobox();break}}function F(d){s("change",d),o.nullable.value&&o.mode.value===0&&d.target.value===""&&p(),o.openCombobox()}function b(d){var R,w,M;let r=(R=d.relatedTarget)!=null?R:be.find(_=>_!==d.currentTarget);if(m.value=!1,!((w=O(o.optionsRef))!=null&&w.contains(r))&&!((M=O(o.buttonRef))!=null&&M.contains(r))&&o.comboboxState.value===0)return d.preventDefault(),o.mode.value===0&&(o.nullable.value&&o.value.value===null?p():o.activationTrigger.value!==1&&o.selectActiveOption()),o.closeCombobox()}function C(d){var R,w,M;let r=(R=d.relatedTarget)!=null?R:be.find(_=>_!==d.currentTarget);(w=O(o.buttonRef))!=null&&w.contains(r)||(M=O(o.optionsRef))!=null&&M.contains(r)||o.disabled.value||o.immediate.value&&o.comboboxState.value!==0&&(o.openCombobox(),he().nextFrame(()=>{o.setActivationTrigger(1)}))}let V=S(()=>{var d,R,w,M;return(M=(w=(R=l.defaultValue)!=null?R:o.defaultValue.value!==void 0?(d=l.displayValue)==null?void 0:d.call(l,o.defaultValue.value):null)!=null?w:o.defaultValue.value)!=null?M:""});return()=>{var d,R,w,M,r,_,u;let c={open:o.comboboxState.value===0},{displayValue:g,onChange:x,...T}=l,E={"aria-controls":(d=o.optionsRef.value)==null?void 0:d.id,"aria-expanded":o.comboboxState.value===0,"aria-activedescendant":o.activeOptionIndex.value===null?void 0:o.virtual.value?(R=o.options.value.find($=>!o.virtual.value.disabled($.dataRef.value)&&o.compare($.dataRef.value,o.virtual.value.options[o.activeOptionIndex.value])))==null?void 0:R.id:(w=o.options.value[o.activeOptionIndex.value])==null?void 0:w.id,"aria-labelledby":(_=(M=O(o.labelRef))==null?void 0:M.id)!=null?_:(r=O(o.buttonRef))==null?void 0:r.id,"aria-autocomplete":"list",id:a,onCompositionstart:y,onCompositionend:I,onKeydown:z,onInput:F,onFocus:C,onBlur:b,role:"combobox",type:(u=e.type)!=null?u:"text",tabIndex:0,ref:o.inputRef,defaultValue:V.value,disabled:o.disabled.value===!0?!0:void 0};return W({ourProps:E,theirProps:T,slot:c,attrs:e,slots:n,features:oe.RenderStrategy|oe.Static,name:"ComboboxInput"})}}}),ht=K({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(l,{attrs:s,slots:e,expose:n}){let t=q("ComboboxOptions"),i=`headlessui-combobox-options-${Q()}`;n({el:t.optionsRef,$el:t.optionsRef}),le(()=>{t.optionsPropsRef.value.static=l.static}),le(()=>{t.optionsPropsRef.value.hold=l.hold});let a=Le(),o=S(()=>a!==null?(a.value&ne.Open)===ne.Open:t.comboboxState.value===0);return qe({container:S(()=>O(t.optionsRef)),enabled:S(()=>t.comboboxState.value===0),accept(v){return v.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}}),()=>{var v,m,p;let f={open:t.comboboxState.value===0},h={"aria-labelledby":(p=(v=O(t.labelRef))==null?void 0:v.id)!=null?p:(m=O(t.buttonRef))==null?void 0:m.id,id:i,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0},y=ce(l,["hold"]);return W({ourProps:h,theirProps:y,slot:f,attrs:s,slots:t.virtual.value&&t.comboboxState.value===0?{...e,default:()=>[te(ct,{},e.default)]}:e,features:oe.RenderStrategy|oe.Static,visible:o.value,name:"ComboboxOptions"})}}}),bt=K({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(l,{slots:s,attrs:e,expose:n}){let t=q("ComboboxOption"),i=`headlessui-combobox-option-${Q()}`,a=P(null);n({el:a,$el:a});let o=S(()=>{var b;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(l.value):t.activeOptionIndex.value===null?!1:((b=t.options.value[t.activeOptionIndex.value])==null?void 0:b.id)===i}),v=S(()=>t.isSelected(l.value)),m=Se(Ce,null),p=S(()=>({disabled:l.disabled,value:l.value,domRef:a,order:S(()=>l.order)}));de(()=>t.registerOption(i,p)),Me(()=>t.unregisterOption(i,o.value)),le(()=>{let b=O(a);b&&(m==null||m.value.measureElement(b))}),le(()=>{t.comboboxState.value===0&&o.value&&(t.virtual.value||t.activationTrigger.value!==0&&L(()=>{var b,C;return(C=(b=O(a))==null?void 0:b.scrollIntoView)==null?void 0:C.call(b,{block:"nearest"})}))});function f(b){var C;if(l.disabled||(C=t.virtual.value)!=null&&C.disabled(l.value))return b.preventDefault();t.selectOption(i),je()||requestAnimationFrame(()=>{var V;return(V=O(t.inputRef))==null?void 0:V.focus({preventScroll:!0})}),t.mode.value===0&&requestAnimationFrame(()=>t.closeCombobox())}function h(){var b;if(l.disabled||(b=t.virtual.value)!=null&&b.disabled(l.value))return t.goToOption(k.Nothing);let C=t.calculateIndex(l.value);t.goToOption(k.Specific,C)}let y=nt();function I(b){y.update(b)}function z(b){var C;if(!y.wasMoved(b)||l.disabled||(C=t.virtual.value)!=null&&C.disabled(l.value)||o.value)return;let V=t.calculateIndex(l.value);t.goToOption(k.Specific,V,0)}function F(b){var C;y.wasMoved(b)&&(l.disabled||(C=t.virtual.value)!=null&&C.disabled(l.value)||o.value&&(t.optionsPropsRef.value.hold||t.goToOption(k.Nothing)))}return()=>{let{disabled:b}=l,C={active:o.value,selected:v.value,disabled:b},V={id:i,ref:a,role:"option",tabIndex:b===!0?void 0:-1,"aria-disabled":b===!0?!0:void 0,"aria-selected":v.value,disabled:void 0,onClick:f,onFocus:h,onPointerenter:I,onMouseenter:I,onPointermove:z,onMousemove:z,onPointerleave:F,onMouseleave:F},d=ce(l,["order","value"]);return W({ourProps:V,theirProps:d,slot:C,attrs:e,slots:s,name:"ComboboxOption"})}}});const gt={name:"FormSelectComponent",props:["modelValue","options"],emits:["update:modelValue"],components:{Combobox:vt,ComboboxButton:ft,ComboboxInput:mt,ComboboxLabel:pt,ComboboxOption:bt,ComboboxOptions:ht},data(){return{query:""}},computed:{attrs(){return{...this.$attrs,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"}},value:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}},filteredOptions(){return this.options.filter(l=>l.label.toLowerCase().includes(this.query.toLowerCase()))},selectedOption(){return Array.isArray(this.value)?null:this.options.filter(l=>l.value==this.value)},selectedOptions(){return Array.isArray(this.value)?this.options.filter(l=>this.value.includes(l.value)):[]}},watch:{value:{handler(){this.$attrs.multiple&&(this.query="")},immediate:!0,deep:!0}},methods:{setValue(l){console.log(l)}}},xt={class:"relative"},yt=N("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-5 w-5 text-gray-400"},[N("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 0 1 1.06 0l3.75 3.75a.75.75 0 0 1-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 0 1-1.06-1.06l3.75-3.75Zm-3.75 9.75a.75.75 0 0 1 1.06 0L12 17.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-3.75 3.75a.75.75 0 0 1-1.06 0l-3.75-3.75a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1),St=N("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-5 h-5"},[N("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})],-1),Ot=[St],It={key:0,class:"flex flex-wrap gap-2 mt-4"},Ct=["onClick"],wt=N("span",{class:"text-red-500 ml-1 text-base"}," × ",-1);function Rt(l,s,e,n,t,i){const a=U("ComboboxInput"),o=U("ComboboxButton"),v=U("ComboboxOption"),m=U("ComboboxOptions"),p=U("v-badge"),f=U("Combobox");return A(),Y(f,{as:"div",modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=h=>i.value=h),multiple:l.$attrs.multiple},{default:G(()=>[N("div",xt,[l.$attrs.multiple?(A(),Y(a,{key:0,class:"w-full rounded-md border border-gray-200 bg-white py-2.5 pl-3 pr-10 text-gray-900 ring-0 ring-inset ring-gray-300 focus:ring-1 focus:ring-inset focus:ring-primary-500 text-sm",onChange:s[0]||(s[0]=h=>t.query=h.target.value),placeholder:"Search ..."})):(A(),Y(a,{key:1,class:"w-full rounded-md border border-gray-200 bg-white py-2.5 pl-3 pr-10 text-gray-900 ring-0 ring-inset ring-gray-300 focus:ring-1 focus:ring-inset focus:ring-primary-500 text-sm",onChange:s[1]||(s[1]=h=>t.query=h.target.value),"display-value":h=>{var y;return(y=e.options.find(I=>h==I.value))==null?void 0:y.label},placeholder:"Search ..."},null,8,["display-value"])),pe(o,{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:G(()=>[yt]),_:1}),i.filteredOptions.length>0?(A(),Y(m,{key:2,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:G(()=>[(A(!0),X(ue,null,fe(i.filteredOptions,(h,y)=>(A(),Y(v,{key:"option_"+y,value:h.value,as:"template"},{default:G(({active:I,selected:z})=>[N("li",{class:ae(["relative cursor-default select-none py-2 pl-3 pr-9",I?"bg-primary-500 text-white":"text-gray-900"])},[N("span",{class:ae(["block truncate",z&&"font-semibold"])},me(h.label),3),z?(A(),X("span",{key:0,class:ae(["absolute inset-y-0 right-0 flex items-center pr-4",I?"text-white":"text-primary-500"])},Ot,2)):se("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):se("",!0)]),l.$attrs.multiple&&i.selectedOptions?(A(),X("div",It,[(A(!0),X(ue,null,fe(i.selectedOptions,(h,y)=>(A(),X("a",{key:"selectedOption_"+y,href:"#",onClick:ke(I=>i.value.splice(i.value.indexOf(h.value),1),["stop"])},[pe(p,{class:"hover:bg-gray-300 cursor-pointer"},{default:G(()=>[ze(me(h.label)+" ",1),wt]),_:2},1024)],8,Ct))),128))])):se("",!0)]),_:1},8,["modelValue","multiple"])}const Dt=Pe(gt,[["render",Rt]]);export{Dt as default};
